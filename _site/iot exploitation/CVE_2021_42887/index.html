<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>CVE-2021-42887: TOTOLINK EX1200T LOGIN BYPASS - Zeyad Azima</title>
<meta name="description" content="A detailed analysis for a login bypass vulnerability that affects the TOTOLINK EX1200T device. ">


  <meta name="author" content="Zeyad Azima">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Zeyad Azima">
<meta property="og:title" content="CVE-2021-42887: TOTOLINK EX1200T LOGIN BYPASS">
<meta property="og:url" content="http://localhost:5000/iot%20exploitation/CVE_2021_42887/">


  <meta property="og:description" content="A detailed analysis for a login bypass vulnerability that affects the TOTOLINK EX1200T device. ">



  <meta property="og:image" content="http://localhost:5000/assets/images/clf6qyw3s1ida0kqjfuacee8r.png">





  <meta property="article:published_time" content="2023-03-13T00:00:00+08:00">





  

  


<link rel="canonical" href="http://localhost:5000/iot%20exploitation/CVE_2021_42887/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Zeyad Azima",
      "url": "http://localhost:5000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Zeyad Azima Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site_data/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site_data/favicon-16x16.png">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/site_data/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Zeyad Azima
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/#Security-Research">Security Research</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#MacOS">MacOS</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#IoT-Exploitation">IoT Exploitation</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Defense-Evasion">Defense Evasion</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#General">General</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Certificates">Certificates</a>
            </li><li class="masthead__menu-item">
              <a href="/categories">All Categories</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/site_data/avatar.jpg" alt="Zeyad Azima" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Zeyad Azima</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Brain Storming Stuff (Exploit Development, Reverse Engineering &amp; More)</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:contact@zeyadazima.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://twitter.com/AzimaZeyad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/zer0verflow/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/Zeyad-Azima" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.buymeacoffee.com/zeyadazima" rel="nofollow noopener noreferrer"><i class="fas fa-mug-hot" aria-hidden="true"></i><span class="label">Buy Me a Coffee</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="CVE-2021-42887: TOTOLINK EX1200T LOGIN BYPASS">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2023-03-13T00:00:00+08:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">CVE-2021-42887: TOTOLINK EX1200T LOGIN BYPASS
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  20 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#obtaining-the-firmware">Obtaining the Firmware</a></li>
  <li><a href="#the-analysis">The Analysis</a></li>
  <li><a href="#final-thoughts">Final Thoughts</a></li>
  <li><a href="#conclusion">Conclusion</a>
    <ul>
      <li><a href="#references">References</a></li>
    </ul>
  </li>
</ul>

            </nav>
          </aside>
        
        <h1 id="introduction"><strong>Introduction</strong></h1>

<p>A vulnerability discovered in TOTOLINK <code class="language-plaintext highlighter-rouge">EX1200T</code> model known as <code class="language-plaintext highlighter-rouge">CVE-2021-42887</code> which lead to authentication bypass, as a results anyone exploit this vulnerability by sending a specific request through <code class="language-plaintext highlighter-rouge">formLoginAuth.htm</code> page will be able to access the device without a need to login then control the device. Note:(<code class="language-plaintext highlighter-rouge">Everything you obtain here is for educational purposes, Don't use or abuse any bug against any target without permissions</code>)</p>

<h1 id="obtaining-the-firmware"><strong>Obtaining the Firmware</strong></h1>

<p>Before we start we would need the firmware of the device, Therefore We can take a static look at the code and how it works to understand more. So, what we need is the vulnerable Firmware for the device which is <code class="language-plaintext highlighter-rouge">V4.1.2cu.5215</code> and we have many ways to do it:</p>

<ul>
  <li>
    <p>You can search for the firmware on the official website for the vendor.</p>
  </li>
  <li>
    <p>Download it from any other source (after someone already dump it from the device and published it).</p>
  </li>
  <li>
    <p>Dump the firmware through <code class="language-plaintext highlighter-rouge">UART</code>, You could read a detailed blog from <a href="https://www.cyberark.com/resources/threat-research-blog/accessing-and-dumping-firmware-through-uart">Here</a>.</p>
  </li>
  <li>
    <p>Also, you could contact the support to provide you with the firmware.</p>
  </li>
  <li>
    <p>Finally dumping the firmware using <code class="language-plaintext highlighter-rouge">CH341A</code> Mini programmer USB, You could read a detailed blog from <a href="https://www.blackhillsinfosec.com/dumping-firmware-with-the-ch341a-programmer/">Here</a>.</p>
  </li>
</ul>

<p>In my case, I found the firmware on the vendor website. Now, Let’s extract the firmware using <code class="language-plaintext highlighter-rouge">binwalk</code> tool as the following <code class="language-plaintext highlighter-rouge">binwalk -e --run-as=root "TOTOLINK_C8180E-1C_EX1200T_WX022_8197F_SPI_8M64M_V4.1.2cu.5215_B20210330_ALL.web"</code> and here is the output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ls
TOTOLINK_C8180E-1C_EX1200T_WX022_8197F_SPI_8M64M_V4.1.2cu.5215_B20210330_ALL.web
$ sudo binwalk -e --run-as=root "TOTOLINK_C8180E-1C_EX1200T_WX022_8197F_SPI_8M64M_V4.1.2cu.5215_B20210330_ALL.web"
[sudo] password for azima:

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
76            0x4C            JFFS2 filesystem, little endian
209052        0x3309C         Zlib compressed data, compressed
209388        0x331EC         Zlib compressed data, compressed
210144        0x334E0         Zlib compressed data, compressed
210832        0x33790         JFFS2 filesystem, little endian
231428        0x38804         Zlib compressed data, compressed
231988        0x38A34         Zlib compressed data, compressed
232548        0x38C64         Zlib compressed data, compressed
233116        0x38E9C         Zlib compressed data, compressed
233560        0x39058         JFFS2 filesystem, little endian
254344        0x3E188         Zlib compressed data, compressed
254696        0x3E2E8         JFFS2 filesystem, little endian
255224        0x3E4F8         Zlib compressed data, compressed
256064        0x3E840         JFFS2 filesystem, little endian
321636        0x4E864         LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 6526520 bytes
</code></pre></div></div>

<p>And as i am using <code class="language-plaintext highlighter-rouge">Windows Subsystem Linux (WSL)</code>, Here we can browser our firmware normally:</p>

<p><img src="/assets/images/d3b3284fe3f5e121ba039bf43d45bca8" alt="" /></p>

<h1 id="the-analysis"><strong>The Analysis</strong></h1>

<p>It’s the time for the analysis. We will need <code class="language-plaintext highlighter-rouge">Burp Suite</code> to see how is the request of the authentication looks like on the device before it’s go to the device web server.</p>

<p> </p>

<p><img src="/assets/images/3e7837b95070275b4c73f2607eadc00a" alt="" /></p>

<p>As we can see in the above screenshot from <code class="language-plaintext highlighter-rouge">Burp Suite</code>, We can notice that the web app made out of <code class="language-plaintext highlighter-rouge">Aasp.net</code> and the <code class="language-plaintext highlighter-rouge">formLoginAuth.htm</code> is requested, If we go to it and take a look at the request which is as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /formLoginAuth.htm?authCode=1&amp;userName=admin&amp;password=admin&amp;goURL=home.asp&amp;action=login HTTP/1.1
Host: 192.168.0.254
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.254/login.asp
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
</code></pre></div></div>

<p>We can guess that this <code class="language-plaintext highlighter-rouge">html</code> page take the parameters as the following: <code class="language-plaintext highlighter-rouge">authCode</code>, <code class="language-plaintext highlighter-rouge">userName</code>, <code class="language-plaintext highlighter-rouge">password</code>, <code class="language-plaintext highlighter-rouge">goURL</code> &amp; <code class="language-plaintext highlighter-rouge">action</code>. And then pass it to one of the <code class="language-plaintext highlighter-rouge">ASP</code> endpoints. So, Let’s go to the firmware we extracted and check the <code class="language-plaintext highlighter-rouge">formLoginAuth.htm</code>. Before that we can see also the <code class="language-plaintext highlighter-rouge">login.asp</code>, But if we go to it the request and the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /login.asp HTTP/1.1
Host: 192.168.0.254
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
DNT: 1
Connection: close
Referer: http://192.168.0.254/
Upgrade-Insecure-Requests: 1
If-Modified-Since: Thu, 01 Jan 1970 00:00:03 GMT
If-None-Match: "-1518032379"
</code></pre></div></div>

<p>And if you take a look at the <code class="language-plaintext highlighter-rouge">URL</code> it just for the login page you see. Let’s move forward with <code class="language-plaintext highlighter-rouge">formLoginAuth.htm</code>. By going to the <code class="language-plaintext highlighter-rouge">\squashfs-root\web_cste</code> directory we can find our web app files:</p>

<p><img src="/assets/images/399c1fd22523740eb10abf5fe94556c3" alt="" /></p>

<p> </p>

<p>As you can see we can’t find <code class="language-plaintext highlighter-rouge">formLoginAuth.htm</code> you may think this page only get generated on the login process at the Runtime. Unforently, I checked it by accessing the device through <code class="language-plaintext highlighter-rouge">telnet</code> and it’s not get created. But, we have our <code class="language-plaintext highlighter-rouge">login.asp</code> page let’s take a look on this page. While going through the code ypu can notice that the login request is sent to <code class="language-plaintext highlighter-rouge">cstecgi.cgi</code> page in the <code class="language-plaintext highlighter-rouge">cgi-bin</code> directory:</p>

<p> </p>

<p><img src="/assets/images/e4b83b2f774f214648024efc3b0a6d59" alt="" /></p>

<p> </p>

<p>And by going back to <code class="language-plaintext highlighter-rouge">Burp Suite</code> again, You can find the following requests made to the page:</p>

<p><img src="/assets/images/5cbe01347552bf8df81a5e2d4f7adbc7" alt="" /></p>

<p> </p>

<p>We can see the login request obvious and by checking it out we can confirm it’s where the login request get process through it:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /cgi-bin/cstecgi.cgi?action=login HTTP/1.1
Host: 192.168.0.254
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 29
Origin: http://192.168.0.254
DNT: 1
Connection: close
Referer: http://192.168.0.254/login.asp
Upgrade-Insecure-Requests: 1

username=admin&amp;password=admin
</code></pre></div></div>

<p>Now, By going to the file and check it with the <code class="language-plaintext highlighter-rouge">file</code> command, We can see it’s an <code class="language-plaintext highlighter-rouge">ELF 32bit MIPS</code> file:</p>

<p><img src="/assets/images/48ec7cb2668c9472fae20b66fa4affb7" alt="" /></p>

<p>It’s the time to do some reverse using <code class="language-plaintext highlighter-rouge">Ghidra</code>, Open it and create a new project i named it <code class="language-plaintext highlighter-rouge">EX1200T</code> for the device name and drop the <code class="language-plaintext highlighter-rouge">cstecgi.cgi</code> file into the project:</p>

<p><img src="/assets/images/b7f5c6d18e0c265298daa5ac8012a16e" alt="" /></p>

<p>After that open the file using <code class="language-plaintext highlighter-rouge">Code Browser</code> within <code class="language-plaintext highlighter-rouge">Ghidra</code>:</p>

<p><img src="/assets/images/8206f1f35ff6a9d40f86cfa58e33391a" alt="" /></p>

<p>Then, analysis the file:</p>

<p><img src="/assets/images/da1ddc7f23209d071f51cb391f97dc9d" alt="" /></p>

<p>Navigating to <code class="language-plaintext highlighter-rouge">Symbol Tree</code> and let’s check out the functions:</p>

<p><img src="/assets/images/e15843ce83bfae14416e1ee5cc31647c" alt="" /></p>

<p>After going through the functions clearly inside <code class="language-plaintext highlighter-rouge">FUN_00400dd8</code> function we can see the following lines of codes. But, there is no thing interesting and it’s all about functions calling other functions:</p>

<p><img src="/assets/images/678cb507c6cc5b22ae2c4511edd3e469" alt="" /></p>

<p>We just can see that <code class="language-plaintext highlighter-rouge">httpStatus</code>, <code class="language-plaintext highlighter-rouge">redirectURL</code> &amp; <code class="language-plaintext highlighter-rouge">responseParam</code> being passed to some unclear functions. But, After a long time of searching you can see under <code class="language-plaintext highlighter-rouge">\squashfs-root\lib\cste_modules</code> folder that there are libraries named as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.so
cloudupdate.so
global.so
lan.so
product.so
system.so
upgrade.so
wireless.so
wps.so
</code></pre></div></div>

<p>After reversing this libraries you will know that it’s clearly used by the <code class="language-plaintext highlighter-rouge">cstecgi.cgi</code> to perform different operations and changes through the device panel. Let’s identify which one perform the login process by searching through the following <code class="language-plaintext highlighter-rouge">Bash</code> one liner using <code class="language-plaintext highlighter-rouge">strings</code> command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for i in $(ls -la | awk '{print $9}' | grep ".so"); do echo ""; echo "Lib Name: $i"; strings $i | grep "login"; done
</code></pre></div></div>

<p>The above line will print the library name after this will run the <code class="language-plaintext highlighter-rouge">strings</code> command on the library to get any string has the work <code class="language-plaintext highlighter-rouge">login</code> and will print the results under the library name. Therefore, we will be able to know which library contains the <code class="language-plaintext highlighter-rouge">login</code> process or anything related. Command output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Lib Name: app.so

Lib Name: cloudupdate.so

Lib Name: global.so
loginAuth
loginflag
loginAuth
loginAuthUrl
mobile/login.asp
login.asp
,"redirectURL":"http://%s/formLoginAuth.htm?authCode=%d&amp;userName=%s&amp;password=%s&amp;goURL=%s&amp;action=login&amp;flag=1"}
,"redirectURL":"http://%s/formLoginAuth.htm?authCode=%d&amp;userName=%s&amp;password=%s&amp;goURL=%s&amp;action=login"}
loginpass
loginFlag
loginIp

Lib Name: lan.so

Lib Name: product.so

Lib Name: system.so

Lib Name: upgrade.so

Lib Name: wireless.so

Lib Name: wps.so
</code></pre></div></div>

<p>And as we can see it’s with-in the <code class="language-plaintext highlighter-rouge">global.so</code> library, As we did with the <code class="language-plaintext highlighter-rouge">cstecgi.cgi</code> file. Let’s do the same with the library with <code class="language-plaintext highlighter-rouge">Ghidra</code>. After opening the <code class="language-plaintext highlighter-rouge">Functions</code> tab under <code class="language-plaintext highlighter-rouge">Symbol Tree</code> we can notice the <code class="language-plaintext highlighter-rouge">loginAuth</code> function:</p>

<p><img src="/assets/images/2316070fb027146d1fc119a3451a0e3b" alt="" /></p>

<p>So, the flaw of the login process is as the following:</p>

<p><img src="/assets/images/c8c2b74880a30421bff4365182521cb2" alt="" /></p>

<p>Now, Let’s navigate to the function and understand what this function do and how it works. First the function start by taking 3 parameters</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void loginAuth(undefined4 param_1,undefined4 param_2,undefined4 param_3)
</code></pre></div></div>

<p>Which are <code class="language-plaintext highlighter-rouge">param_1</code>, <code class="language-plaintext highlighter-rouge">param_2</code> and <code class="language-plaintext highlighter-rouge">param_3</code>. By going through the rest of the code you gonna see that mostly are declaring of variables, Until we reach the line number <code class="language-plaintext highlighter-rouge">73</code>:</p>

<p><img src="/assets/images/3d9279131f711b45a1e1293da25ecb59" alt="" /></p>

<p>We can see here it’s created 3 variables:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">uVar1</code>: In this variable it’s assigning a value of calling a function called <code class="language-plaintext highlighter-rouge">websGetVar()</code> and passing <code class="language-plaintext highlighter-rouge">param_2</code>, <code class="language-plaintext highlighter-rouge">LoginAuthUrl</code> which it could be the <code class="language-plaintext highlighter-rouge">HTML</code> page and an empty string at the end. (<code class="language-plaintext highlighter-rouge">We will back to this function used again</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">uVar2</code> : Here it’s assigning this variable to store json objects.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">iVar5</code>: Here it’s assigning <code class="language-plaintext highlighter-rouge">0</code>.<br />
  after that we can see a while loop and inside the loop we can see the following:</p>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  while( true ) {
    iVar8 = iVar5 + 1;
    iVar5 = getNthValueSafe(iVar5,uVar1,0x26,auStack_1718,0x400);
    if (iVar5 == -1) break;
    iVar3 = getNthValueSafe(0,auStack_1718,0x3d,auStack_1318,0x80);
    iVar5 = iVar8;
    if ((iVar3 != -1) &amp;&amp;
       (iVar8 = getNthValueSafe(1,auStack_1718,0x3d,auStack_1298,0x100), iVar8 != -1)) {
      uVar4 = cJSON_CreateString(auStack_1298);
      cJSON_AddItemToObject(uVar2,auStack_1318,uVar4);
    }
  }
</code></pre></div></div>

<p>In this loop it’s adding <code class="language-plaintext highlighter-rouge">1</code> to <code class="language-plaintext highlighter-rouge">iVar5</code> which is <code class="language-plaintext highlighter-rouge">0</code> above and after that assign the result to <code class="language-plaintext highlighter-rouge">iVar8</code> variable. After that calling a function <code class="language-plaintext highlighter-rouge">getNthValueSafe()</code> and passing unknown parameters to it after that assign the result to <code class="language-plaintext highlighter-rouge">iVar5</code>. Then, there is an <code class="language-plaintext highlighter-rouge">if</code> condition checks for the value of <code class="language-plaintext highlighter-rouge">iVar5</code> if it’s equal to <code class="language-plaintext highlighter-rouge">-1</code> it will break the loop and if this condition didn’t executed it do the same before the condition with the <code class="language-plaintext highlighter-rouge">iVar5</code> and <code class="language-plaintext highlighter-rouge">getNthValueSafe()</code> function but with different parameters and assign it to <code class="language-plaintext highlighter-rouge">iVar3</code>. Then, It will get back the value of <code class="language-plaintext highlighter-rouge">iVar5</code> by assigning the value of <code class="language-plaintext highlighter-rouge">iVar8</code> to it. in the second <code class="language-plaintext highlighter-rouge">if</code> condition it checks if <code class="language-plaintext highlighter-rouge">iVar3</code> &amp; the <code class="language-plaintext highlighter-rouge">iVar8</code>(After assign the <code class="language-plaintext highlighter-rouge">getNthValueSafe()</code> to it) values are not equal to <code class="language-plaintext highlighter-rouge">-1</code> then it will create unknown <code class="language-plaintext highlighter-rouge">JSON</code> string and assign it to <code class="language-plaintext highlighter-rouge">uVar4</code>, Finally it will add an item to object to <code class="language-plaintext highlighter-rouge">uVar2</code> which created before and it’s the <code class="language-plaintext highlighter-rouge">JSON</code> data then <code class="language-plaintext highlighter-rouge">auStack_1318</code> which is the key and <code class="language-plaintext highlighter-rouge">uVar4</code> which is the value. Let’s move forward with the rest of lines:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>__s1 = (char *)websGetVar(uVar2,"username","admin");
pcVar6 = (char *)websGetVar(uVar2,"password","");
__src = (char *)websGetVar(uVar2,"http_host","");
__nptr = (char *)websGetVar(uVar2,&amp;DAT_0001dd80,"");
apmib_get(0xb6,&amp;local_1198);
apmib_get(0xb7,&amp;local_1174);
apmib_get(0xc0,&amp;local_17a0);
</code></pre></div></div>

<p>Here we can see the following assigned variables which store values retrived by <code class="language-plaintext highlighter-rouge">websGetVar()</code> function let’s go step by step:</p>

<ul>
  <li>
    <p><strong>__s1</strong>: storing the value retrieved with <code class="language-plaintext highlighter-rouge">username</code> from the http request and the <code class="language-plaintext highlighter-rouge">admin</code> value will be used if the requested variable is not found.</p>
  </li>
  <li>
    <p><strong>pcVar6</strong>: storing the value retrieved with <code class="language-plaintext highlighter-rouge">password</code> from the http request and the <code class="language-plaintext highlighter-rouge">""</code> value will be used if the requested variable is not found.</p>
  </li>
  <li>
    <p><strong>__src</strong>: storing the value retrieved with <code class="language-plaintext highlighter-rouge">http_host</code> from the http request and the <code class="language-plaintext highlighter-rouge">""</code> value will be used if the requested variable is not found.</p>
  </li>
  <li>
    <p><strong>__nptr</strong>: storing the value referenced by the memory address <code class="language-plaintext highlighter-rouge">&amp;DAT_0001dd80</code> from the http request and the <code class="language-plaintext highlighter-rouge">""</code> value will be used if the requested variable is not found.</p>
  </li>
</ul>

<p>Note: let’s rename each variable that stores a value so we can make the code more clearly.<br />
Finally, each call for the <code class="language-plaintext highlighter-rouge">apmib_get()</code> function is for retrieving a value from a data structure and storing it in a local variable <code class="language-plaintext highlighter-rouge">local_x</code> for later use. So, we can complete with the rest of the code:</p>

<p><img src="/assets/images/0d59c62a9ae4bb191888b2b5255f9a7a" alt="" /></p>

<p> </p>

<p>After renaming the variables, We can see it’s became more clearly now. IN the lines after the previous lines, There is an <code class="language-plaintext highlighter-rouge">IF</code> condition which checks if the first character of <code class="language-plaintext highlighter-rouge">Host</code> is null character or no, If that true it will call a function named <code class="language-plaintext highlighter-rouge">getLanIp()</code> and from it’s name we can guess it’s getting the IP address for the device <code class="language-plaintext highlighter-rouge">NIC</code> so the <code class="language-plaintext highlighter-rouge">acStack_1150</code> variable is the device interface. So, let’s rename it and after we rename it. Everything is clear it checks for the <code class="language-plaintext highlighter-rouge">Hostname or IP</code>. Finally, if it’s not then it will copy the <code class="language-plaintext highlighter-rouge">Host</code> value to the <code class="language-plaintext highlighter-rouge">deviceInterface</code> which also could be a host-name.</p>

<p><img src="/assets/images/d7af7345820f95322cff9e281ce15be0" alt="" /></p>

<p>By checking the next line, It also another condition to check the <code class="language-plaintext highlighter-rouge">username</code> and password:</p>

<p><img src="/assets/images/eed944780534881324ecba4cca762538" alt="" /></p>

<p>It checks if the <code class="language-plaintext highlighter-rouge">userName</code> or <code class="language-plaintext highlighter-rouge">passWord</code> is null character or no, If yes, then it will set the <code class="language-plaintext highlighter-rouge">loginflag</code> to <code class="language-plaintext highlighter-rouge">1</code> which maybe indicates that the login is failed. and if this doesn’t happen it comparing the <code class="language-plaintext highlighter-rouge">userName</code> with <code class="language-plaintext highlighter-rouge">local_1198</code> and store the results to <code class="language-plaintext highlighter-rouge">iVar5</code> and for the <code class="language-plaintext highlighter-rouge">local_1198</code> then if the results not equal to <code class="language-plaintext highlighter-rouge">0</code> that means it fails and will set the <code class="language-plaintext highlighter-rouge">loginflag</code> to <code class="language-plaintext highlighter-rouge">1</code>, if we go to the previous line we can see that this variable in the following line <code class="language-plaintext highlighter-rouge">apmib_get(0xb6,&amp;local_1198);</code> and we remember that the <code class="language-plaintext highlighter-rouge">apmlib_get()</code> function is for retrieving a value from a data structure and storing it in a local variable and by doing some search the value is from the configuration. So, we can guess that this variable carry the device username so let’s rename it. And moving to the next lines:</p>

<p><img src="/assets/images/a6db966fcfa7c428837f84c5b24883df" alt="" /></p>

<p>As we can see there is <code class="language-plaintext highlighter-rouge">passwordTrans()</code> function which takes 2 parameters the <code class="language-plaintext highlighter-rouge">passWord</code> parameter and another parameter which is <code class="language-plaintext highlighter-rouge">acStack_50</code>. By clicking on the <code class="language-plaintext highlighter-rouge">passwordTrans()</code> function we can see the following code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void passwordTrans(int param_1,char *param_2)

{
  char cVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  char *pcVar5;
  
  iVar4 = 1;
  iVar3 = 0;
  pcVar5 = param_2;
  while( true ) {
    cVar1 = *(char *)(param_1 + iVar3);
    if (cVar1 == '\0') break;
    if (cVar1 == '%') {
      iVar2 = hextochar(*(char *)(param_1 + iVar3 + 1),*(char *)(param_1 + iVar3 + 2));
      *pcVar5 = (char)iVar2;
      iVar3 = iVar3 + 3;
    }
    else {
      *pcVar5 = cVar1;
      iVar3 = iVar3 + 1;
    }
    iVar4 = iVar4 + 1;
    pcVar5 = pcVar5 + 1;
  }
  param_2[iVar4 + -1] = '\0';
  return;
}
</code></pre></div></div>

<p>Basically, the <code class="language-plaintext highlighter-rouge">passwordTrans()</code> function appears to take a encoded password string and returns the decoded password string by replacing any percent encoded characters with their <code class="language-plaintext highlighter-rouge">ASCII</code> equivalent characters by iterating through each character in the password string, checking if the character is a percent sign and converting the two <code class="language-plaintext highlighter-rouge">hexadecimal</code> characters following the percent sign to their <code class="language-plaintext highlighter-rouge">ASCII</code> equivalent, Then it saves it in the second passed parameter which in this case is <code class="language-plaintext highlighter-rouge">acStack_50</code>. So, We can guess that this is the final password, Let’s rename it to <code class="language-plaintext highlighter-rouge">finalPassword</code>. By going back to our <code class="language-plaintext highlighter-rouge">loginAuth()</code> function. After the <code class="language-plaintext highlighter-rouge">passwordTrans()</code> function call we can see the following:</p>

<p><img src="/assets/images/cc887279e8c5901ef14051bb7a99bb93" alt="" /></p>

<p>Here it compares the <code class="language-plaintext highlighter-rouge">finalPassword</code> with a variable loaded using <code class="language-plaintext highlighter-rouge">memset()</code> function and we can guess it’s the configured password (so we will rename it to <code class="language-plaintext highlighter-rouge">devicePassword</code>), and it’s assign the result into the <code class="language-plaintext highlighter-rouge">iVar5</code> &amp; After that it checks if the <code class="language-plaintext highlighter-rouge">iVar5</code> is not equal to <code class="language-plaintext highlighter-rouge">0</code> which indicates that the login is not successful and set the <code class="language-plaintext highlighter-rouge">loginflag</code> to <code class="language-plaintext highlighter-rouge">1</code>. After that coming the next lines</p>

<p><img src="/assets/images/6c6878d672bd778489da9277b13f588c" alt="" /></p>

<p>It comparing the <code class="language-plaintext highlighter-rouge">userName</code> provided by the user with the one in the device which is <code class="language-plaintext highlighter-rouge">deviceUserName</code> and storing the results, then it checks if <code class="language-plaintext highlighter-rouge">iVar5</code> is equal to <code class="language-plaintext highlighter-rouge">0</code> and do another compare between <code class="language-plaintext highlighter-rouge">finalPassword</code> and <code class="language-plaintext highlighter-rouge">devicePassword</code> and save the results also in <code class="language-plaintext highlighter-rouge">iVar5</code>. If the condition is true then it will set the <code class="language-plaintext highlighter-rouge">loginflag</code> to <code class="language-plaintext highlighter-rouge">0</code>, As a results the login is successful. After that it uses the <code class="language-plaintext highlighter-rouge">apmib_get()</code> function to get some configuration. And now by looking into the next lines:</p>

<p><img src="/assets/images/9a695a447df24dafaaf4a243aa4f03f4" alt="" /></p>

<p>In these lines it’s all about conditions that will be executed, If the previous condition is true. By taking a look we can see it checks if the <code class="language-plaintext highlighter-rouge">local_17a0</code> is equal to <code class="language-plaintext highlighter-rouge">0</code> which we don’t know yet. Then it create the <code class="language-plaintext highlighter-rouge">iVar5</code> stores the value of <code class="language-plaintext highlighter-rouge">__nptr</code> which converted by <code class="language-plaintext highlighter-rouge">atoi()</code> function which converts a string of characters representing an integer value into an actual integer value. Then it checks if <code class="language-plaintext highlighter-rouge">iVar5</code> to <code class="language-plaintext highlighter-rouge">1</code> and then assign some values to the <code class="language-plaintext highlighter-rouge">local_x</code> variables in this point if we take a look at the disassembled code we can notice the following:</p>

<p><img src="/assets/images/0a9c4ebed4c57e9f7c8d7168613181d5" alt="" /></p>

<p>And now it’s obvious that it loads a word and it’s is <code class="language-plaintext highlighter-rouge">mobie/home.asp</code> which is a mobile user endpoint, Now we can say that the <code class="language-plaintext highlighter-rouge">__nptr</code> is used to check if the user is on Desktop or Mobile, So let’s rename it as <code class="language-plaintext highlighter-rouge">mobileUser</code> and rename the <code class="language-plaintext highlighter-rouge">local_x</code> variables and it’s values. So we can say the code will be as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iVar5 = atoi(mobileUser);
if (iVar5 == 1) {
    endPoint = "mobile/home.asp";
}
</code></pre></div></div>

<p>If this condition didn’t achieved then it will check for the Desktop User as we can see also in the disassembled code has the <code class="language-plaintext highlighter-rouge">home.asp</code> without mobile:</p>

<p><img src="/assets/images/9de036a2b5076aa9712b7ca1372861ab" alt="" /></p>

<p>And after that if the user desktop or mobile is not identified it will be <code class="language-plaintext highlighter-rouge">wizard.asp</code> endpoint as we can see:</p>

<p><img src="/assets/images/27aa47c23253ed600c1dbd8ff1eaac40" alt="" /></p>

<p>So, the full clear code as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (local_17a0 == 0) {
  iVar5 = atoi(mobileUser);
  if (iVar5 == 1) {
        endPoint = "mobile/home.asp";
  }
  else if (desktopUser == 1) {
        endPoint = "home.asp";
  }
  else {
        endPoint = "wizard.asp";
  }
</code></pre></div></div>

<p>Now, if the first condition which is <code class="language-plaintext highlighter-rouge">if (local_17a0 == 0) {</code> not true then it will jump to the following:</p>

<p><img src="/assets/images/45453627725187f052cf14523273ab6e" alt="" /></p>

<p>Which also check if the User is on mobile or desktop, Then back to the condition that check the credentials which is <code class="language-plaintext highlighter-rouge">if ((iVar5 == 0) &amp;&amp; (iVar5 = strcmp(finalPassword,(char *)&amp;devicePassword), iVar5 == 0)</code> if it’s not true it will check if the user is on mobile or no and assign the <code class="language-plaintext highlighter-rouge">mobile/login.asp</code> endpoint which the user will redirect to it:</p>

<p><img src="/assets/images/1cb414c7e9f66678b985a7bb54648014" alt="" /></p>

<p>So, the clear code for this is as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (local_17a0 == 0) {
  iVar5 = atoi(mobileUser);
  if (iVar5 == 1) {
        endPoint = "mobile/home.asp";
  }
  else if (desktopUser == 1) {
        endPoint = "home.asp";
  }
  else {
        endPoint = "wizard.asp";
  }
else {
iVar5 = atoi(mobileUser);
    if (iVar5 == 1) {
  endPoint = "mobile/login.asp";
  iVar5 = 0;
}
    else {
  endPoint = "login.asp";
  iVar5 = 0;
}
}
</code></pre></div></div>

<p>From the clear code we can guess that <code class="language-plaintext highlighter-rouge">local_17a0</code> is checks for the authentication or the login. So, we will rename it to <code class="language-plaintext highlighter-rouge">isAuth</code>. Now, we getting closer to the place of the bug as we see:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snprintf(acStack_1050,0x1000,"{\"httpStatus\":\"%s\",\"host\":\"%s\"","302",deviceInterface);
</code></pre></div></div>

<p>Here, It assigns the status of request to the <code class="language-plaintext highlighter-rouge">acSTack_1050</code> we can rename it to <code class="language-plaintext highlighter-rouge">reqResponse</code>, In this case it will redirect the user to the login page as authentication failed, Then it will assign the length of the <code class="language-plaintext highlighter-rouge">reqResonse</code> to <code class="language-plaintext highlighter-rouge">sVar6 = strlen(reqResponse);</code> to prevent <code class="language-plaintext highlighter-rouge">overflow</code> attacks. Now, coming here we gonna see it does a check again on the user to see if it’s on Desktop or mobile and here what the developer missed it out:</p>

<p><img src="/assets/images/0c6170dc1432a2d9072363654d6c5229" alt="" /></p>

<p>Out of the first checks this code assign the following to the response if the user is on mobile:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snprintf(reqResponse + sVar6,0x1000 - sVar6,
         ",\"redirectURL\":\"http://%s/formLoginAuth.htm?authCode=%d&amp;userName=%s&amp;password=%s&amp;goU RL=%s&amp;action=login&amp;flag=1\"}"
         ,deviceInterface,iVar5,userName,finalPassword,(char *)&amp;local_1798);
</code></pre></div></div>

<p>The values of the parameters as the following the first <code class="language-plaintext highlighter-rouge">%s</code> is for the <code class="language-plaintext highlighter-rouge">deviceInterface</code> then the second one is <code class="language-plaintext highlighter-rouge">%d</code> which is for <code class="language-plaintext highlighter-rouge">iVar5</code> and if we back to the code where the login check failed it assigned <code class="language-plaintext highlighter-rouge">0</code> to the <code class="language-plaintext highlighter-rouge">iVar5</code>, So we can say that the <code class="language-plaintext highlighter-rouge">iVar5</code> here in this case is for <code class="language-plaintext highlighter-rouge">authCode</code> and it’s equal <code class="language-plaintext highlighter-rouge">0</code> and here it comes the issue as the <code class="language-plaintext highlighter-rouge">authCode</code> value can be passed by the user through a request it can be manipulate all of these parameters. By the way, If it’s not mobile user it will do the same response, But without the <code class="language-plaintext highlighter-rouge">flag=1</code> which indicates that user is mobile. Now, let’s take this response URL and manipulate it:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mydevice/formLoginAuth.htm?authCode=1&amp;userName=admin&amp;password=Idontneedit&amp;goURL=home.asp&amp;action=login
</code></pre></div></div>

<p>If we try it we will be able to see that we bypassed all these checks as the mistakes done by the developer to assign the redirect and response out of the checks.</p>

<p><img src="/assets/images/6f7b4204281bccd78b1ff6521e75375d" alt="" /></p>

<p> </p>

<h1 id="final-thoughts"><strong>Final Thoughts</strong></h1>

<p>The developer created a big mistake in 2 things first sending the response out and after of the checks &amp; relay on <code class="language-plaintext highlighter-rouge">authCode</code> parameter results and it can be manipulated by the user. The developer shall assign the <code class="language-plaintext highlighter-rouge">authCod</code> hardcoded and not editable by the user. But, the best solution is to relay on the username and password as any authentication process which happens in the code and not send them back to the response. The secure code can be as the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// If authentication success
if (isAuth == 0) {
          // create sessin for user
      snprintf(Session, Session_Length, "Set-Cookie: session_id=%s; Path=/\n", session_id);
  iVar5 = atoi(mobileUser);
    // If user on mobile
  if (iVar5 == 1) {
      // assign mobile endpoint
        endPoint = "mobile/home.asp";
      
      // set user authentication to successful
        snprintf(reqResponse + sVar6,0x1000 - sVar6,
         ",\"redirectURL\":\"http://%s/formLoginAuth.htm?goURL=%s&amp;action=login&amp;flag=1\"}"
         ,deviceInterface,(char *)&amp;endPoint);
      // send the response to user and exit
        websGetCfgResponse(param_1,param_3,reqResponse, Session);
        exit(0);
  }
    // if it's a desktop user
  else if (desktopUser == 1) {
      // assign desktop endpoint
        endPoint = "home.asp";
      // set user authentication to successful
        snprintf(reqResponse + sVar6,0x1000 - sVar6,
         ",\"redirectURL\":\"http://%s/formLoginAuth.htm?goURL=%s&amp;action=login\"}"
         ,deviceInterface,(char *)&amp;endPoint);
      // send the response to user and exit
        websGetCfgResponse(param_1,param_3,reqResponse, Session);
        exit(0);
  }
    // if it's not known mobile or desktop
  else {
      // assign wizard.asp endpoint
        endPoint = "wizard.asp";
      // set user authentication to successful
        snprintf(reqResponse + sVar6,0x1000 - sVar6,
         ",\"redirectURL\":\"http://%s/formLoginAuth.htm?goURL=%s&amp;action=login\"}"
         ,deviceInterface,userName,finalPassword,(char *)&amp;endPoint);
       // send the response to user and exit
        websGetCfgResponse(param_1,param_3,reqResponse, Session);
        exit(0);
  }

// If authentication not success
else {
iVar5 = atoi(mobileUser);
    // If user on mobile
  if (iVar5 == 1) {
      // assign mobile endpoint
  endPoint = "mobile/login.asp";
  // send the response to user and exit
      snprintf(reqResponse,0x1000,"{\"httpStatus\":\"%s\",\"host\":\"%s\"","302",deviceInterface, endPoint);
        websGetCfgResponse(param_1,param_3,reqResponse, Session);
        exit(0);
}
    // if it's a desktop user or else
  else {
      // assign desktop endpoint
  endPoint = "login.asp";
        // send the response to user and exit
      snprintf(reqResponse,0x1000,"{\"httpStatus\":\"%s\",\"host\":\"%s\"","302",deviceInterface, endPoint);
      websGetCfgResponse(param_1,param_3,reqResponse, Session);
      exit(0);
}
}
</code></pre></div></div>

<p>In this code the developer will not relay on the <code class="language-plaintext highlighter-rouge">authCode</code> and after any condition came true it will send the response to the user and exit immediately, Which leaves no chance for the user to do anything.</p>

<p> </p>

<h1 id="conclusion"><strong>Conclusion</strong></h1>

<p>In this analysis we saw the root cause of the issue and how it can be solved in an example code, Also how we can analysis the unclear decompiled code to understand as much as we can of the code and make it clear.Finally, You have to keep each code under it’s condition.</p>

<p> </p>

<h2 id="references"><strong>References</strong></h2>

<ul>
  <li>
    <p><a href="https://www.totolink.net/home/news/me_name/id/39/menu_listtpl/DownloadC.html">https://www.totolink.net/home/news/me_name/id/39/menu_listtpl/DownloadC.html</a></p>
  </li>
  <li>
    <p><a href="https://github.com/p1Kk/vuln/blob/dcc2b75ab49f8cb0bdadf6f3c5d6b379a73e57c5/totolink_ex1200t_login_bypass.md">https://github.com/p1Kk/vuln/blob/dcc2b75ab49f8cb0bdadf6f3c5d6b379a73e57c5/totolink_ex1200t_login_bypass.md</a></p>
  </li>
  <li>
    <p>https://ghidra-sre.org/</p>
  </li>
  <li>
    <p><a href="https://github.com/scriptingxss/owasp-fstm/releases/download/v1.0/Firmware_Security_Testing_Methodology_Version1.pdf">https://github.com/scriptingxss/owasp-fstm/releases/download/v1.0/Firmware_Security_Testing_Methodology_Version1.pdf</a></p>

    <p> </p>
  </li>
</ul>

<p>#CVE-2021-42887</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#iot-exploitation" class="page__taxonomy-item" rel="tag">IoT Exploitation</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2023-03-13T00:00:00+08:00">March 13, 2023</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/certificates/ecppt/" class="pagination--pager" title="eCPPT: The Honest Review
">Previous</a>
    
    
      <a href="/iot%20exploitation/CVE_2021_42888/" class="pagination--pager" title="CVE-2021-42888: TOTOLINK EX1200T Remote Command Injection
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Zeyad Azima. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
